name: Deploy impl_space to Hugging Face Space

on:
  push:
    branches:
      - main              # ← デフォルトブランチが main の場合
    paths:
      - "impl_space/**"   # ← HF に同期したいフォルダ名

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Deploy impl_space to Hugging Face Space
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
          HF_USERNAME: ${{ secrets.HF_USERNAME }}
          HF_SPACE: ${{ secrets.HF_SPACE }}
        run: |
          cd impl_space

          git init
          git config user.email "ci@example.com"
          git config user.name "github-actions[bot]"

          git add .
          git commit -m "Deploy from GitHub Actions ${GITHUB_SHA}"

          git remote add origin "https://${HF_USERNAME}:${HF_TOKEN}@huggingface.co/spaces/${HF_USERNAME}/${HF_SPACE}"

          git branch -M main
          git push --force origin main
